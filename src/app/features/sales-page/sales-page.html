<div class="sales-page">
  <!-- Header con estadísticas -->
  <div class="page-header">
    <div class="header-content">
      <div class="header-title">
        <h1>
          <i-lucide [img]="icons.shoppingCart" class="header-icon"></i-lucide>
          Ventas de Dulcería
        </h1>
      </div>
      

      <app-stats-cards [stats]="stats"></app-stats-cards>

      <app-featured-card
        [label]="'Mejor Vendedor'"
        [value]="mejorVendedor"
        [icon]="icons.award">
      </app-featured-card>
    </div>
  </div>

  <!-- Data Table -->
  <app-data-table
    [columns]="columns"
    [data]="displayedData"
    [pagination]="pagination"
    [loading]="loading"
    [showActions]="showActions"
    [showAddButton]="showAddButton"
    [addButtonLabel]="addButtonLabel"
    [showExportButton]="showExportButton"
    [exportTitle]="exportTitle"
    [exportFileName]="exportFileName"
    [exportStats]="{
      totalVentas: totalVentas,
      ventasCompletadas: ventasCompletadas,
      totalIngresos: totalIngresos,
      promedioVenta: promedioVenta
    }"
    (pageChange)="onPageChange($event)"
    (searchChange)="onSearchChange($event)"
    (sort)="onSort($event)"
    (rowClick)="onRowClick($event)"
    (action)="onAction($event)"
    (add)="onAdd()">
    
    <!-- Template personalizado para vendedor -->
    <ng-template let-row>
      <div class="seller-info">
        <i-lucide [img]="icons.users" class="seller-icon"></i-lucide>
        <span class="seller-name">{{ row['nombre_usuario'] }}</span>
      </div>
    </ng-template>

    <!-- Template personalizado para producto -->
    <ng-template let-row>
      <div class="product-info">
        <i-lucide [img]="getSaleIcon(row['icon'])" class="product-icon"></i-lucide>
        <span class="product-name">{{ row['producto'] }}</span>
        <span class="product-quantity">({{ row['cantidad'] }} und)</span>
      </div>
    </ng-template>

    <!-- Template personalizado para fecha -->
    <ng-template let-row>
      <span class="sale-date">{{ formatDate(row['fecha_venta']) }}</span>
    </ng-template>

    <!-- Template personalizado para total -->
    <ng-template let-row>
      <span class="sale-total">{{ formatCurrency(row['total']) }}</span>
    </ng-template>

    <!-- Template personalizado para método de pago -->
    <ng-template let-row>
      <span class="payment-method">{{ getPaymentMethodLabel(row['metodo_pago']) }}</span>
    </ng-template>

    <!-- Template personalizado para estado -->
    <ng-template let-row>
      <div class="sale-status" [class]="getStatusClass(row['estado'])">
        <i-lucide [img]="getStatusIcon(row['estado'])" class="status-icon"></i-lucide>
        {{ row['estado'] }}
      </div>
    </ng-template>
    
  </app-data-table>

  <!-- Modal para nueva venta -->
  <app-modal-form
    [show]="showModal"
    [title]="modalTitle"
    [fields]="modalFields"
    [loading]="modalLoading"
    (save)="onSaveSale($event)"
    (cancel)="onCancelModal()">
  </app-modal-form>
</div>