<div *ngIf="show" class="modal-overlay" (click)="onCancel()">
  <div class="modal-container" (click)="$event.stopPropagation()">
    
    <!-- Header -->
    <div class="modal-header">
      <h2 class="modal-title">{{ title }} </h2>
      <button class="modal-close" (click)="onCancel()" [disabled]="loading">
        ✕
      </button>
    </div>

    <!-- Body -->
    <div class="modal-body">
      <div *ngFor="let field of fields; trackBy: trackByField" class="form-group">
        
        <label class="form-label">
          {{ field.label }}
          <span *ngIf="field.required" class="required">*</span>
        </label>

        <!-- Input de texto/número/email/password -->
        <input
          *ngIf="field.type === 'text' || field.type === 'number' || field.type === 'email' || field.type === 'password'"
          [type]="field.type"
          [placeholder]="field.placeholder || ''"
          [(ngModel)]="formData[field.key]"
          [required]="field.required || false"
          class="form-control">

        <!-- Textarea -->
        <textarea
          *ngIf="field.type === 'textarea'"
          [placeholder]="field.placeholder || ''"
          [(ngModel)]="formData[field.key]"
          [required]="field.required || false"
          class="form-control"></textarea>

        <!-- Select -->
        <select
          *ngIf="field.type === 'select'"
          [(ngModel)]="formData[field.key]"
          [required]="field.required || false"
          class="form-control">
          
          <option value="" disabled selected>
            {{ field.placeholder || 'Selecciona una opción' }}
          </option>
          
          <option 
            *ngFor="let option of field.options || []" 
            [value]="option.value">
            {{ option.label }}
          </option>
        </select>

      </div>
    </div>

    <!-- Footer -->
    <div class="modal-footer">
      <button 
        class="btn btn-cancel" 
        (click)="onCancel()" 
        [disabled]="loading">
        Cancelar
      </button>
      
      <button 
        class="btn btn-save" 
        (click)="onSave()" 
        [disabled]="loading">
        
        <span *ngIf="loading" class="btn-spinner"></span>
        {{ loading ? 'Guardando...' : 'Guardar' }}
        
      </button>
    </div>

  </div>
</div>